syntax = "proto3";
package types;

message Backdrop {
  string name = 1;
  repeated string aliases = 2;
  string container_name = 3;

  string image_id = 4;
  BuildInfo build = 5;

  Entrypoint entrypoint = 6;

  repeated Environment environment = 9;
  repeated Volume volumes = 10;
  repeated Device devices = 11;
  repeated Port ports = 12;

  string user = 13;
  string working_dir = 14;

  bool attach = 15;
}

message Entrypoint {
  bool interactive = 1;
  string script = 2;
  repeated string interpreter = 3;
  repeated string arguments = 4;
}

message BuildInfo {
  string image_name = 1;
  string context = 2;
  string dockerfile = 3;
  repeated string inline_dockerfile = 4;

  repeated Argument arguments = 5;
  repeated Secret secrets = 6;
  repeated SshAgent ssh_agents = 7;

  bool no_cache = 8;
  bool force_rebuild = 9;
  bool force_pull = 10;

  repeated string dependencies = 11;
}

message Argument {
  string key = 1;
  string value = 2;
}

message Environment {
  string key = 1;
  string value = 2;
}

message Volume {
  string source = 1;
  string target = 2;
  bool readonly = 3;
}

message Device {
  string cgroup_rule = 1;
  string source = 2;
  string target = 3;
  string permissions = 4;
}

message Port {
  string target = 1;
  string published = 2;
  string protocol = 3;
  string host_ip = 4;
}

message Secret {
  string id = 1;
  string path = 2;
}

message SshAgent {
  string id = 1;
  string identity_file = 2;
}
